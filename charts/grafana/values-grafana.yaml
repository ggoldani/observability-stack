# Basic Grafana settings
adminUser: admin
adminPassword: admin  # Change in production

# Persistence for dashboards/data
persistence:
  enabled: true
  size: 1Gi

# Pre-configure data sources (Mimir as Prometheus)
datasources:
  datasources.yaml:
    apiVersion: 1
    datasources:
    # Mimir (metrics - prometheus compatible)
    - name: Mimir
      type: prometheus
      url: http://mimir-gateway.observability.svc:80/prometheus
      access: proxy
      isDefault: true
      jsonData:
        httpMethod: POST
        exemplarTraceIdDestinations:
          - name: trace_id
            datasourceUid: tempo

    # Loki (logs)
    - name: Loki
      type: loki
      url: http://loki-gateway.observability.svc:80
      jsonData:
        derivedFields:
          - datasourceUid: tempo
            matcherRegex: "trace_id=(\\w+)"
            name: TraceID
            url: "$${__value.raw}"

    # Tempo (traces)
    - name: Tempo
      type: tempo
      uid: tempo
      url: http://tempo.observability.svc:3200
      access: proxy
      jsonData:
        tracesToLogs:
          datasourceUid: loki
        tracesToMetrics:
          datasourceUid: mimir
        serviceMap:
          datasourceUid: mimir

# Service as LoadBalancer for external access
service:
  type: LoadBalancer

# Disable plugins/subcharts for simplicity
plugins: []
sidecar:
  dashboards:
    enabled: false
  datasources:
    enabled: false

